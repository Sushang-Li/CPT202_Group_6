<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <title>体育管理系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.staticfile.net/twitter-bootstrap/3.3.7/css/bootstrap.min.css">  
    <link rel="shortcut icon" href="images/smallcut.png">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="./css/Admin.css">

</head>
<body>
	<!-- jQuery (Bootstrap 插件需要引入) -->
<script src="https://cdn.staticfile.net/jquery/2.1.1/jquery.min.js"></script>
<!-- 包含了所有编译插件 -->
<script src="https://cdn.staticfile.net/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

<!-- 侧边栏 -->
<div >
    <div class="row">
       <!--  <div class="col-lg-2"> -->
            <div class="sidebar">
                <ul id="side" class="nav nav-pills nav-stacked">
                    <li id="bb"><a href="#"><span class="glyphicon glyphicon-globe"></span><b> Sport manage system</b> </a></li>
               
         

                    <li id="aa" ><a  href="AdminHomePage.html"><span class="glyphicon glyphicon-home"></span> Home</a></li>
                   
                    <li id="a1">
                      <a id="a2" class="active" href="#mangage"><span class="glyphicon glyphicon-edit"></span> manage <span class="glyphicon glyphicon-chevron-right"></span></a>
                      <ul>
                      <li><a id="a3" class="active" href="AdminSportActivitiesPage.html">manage sport activities</a></li>
                      <li><a id="a3" href="AdminStadiumsPage.html">manage stadiums</a></li>
                      <li><a id="a3" href="AdminCoachesPage.html">manage coaches</a></li>
                      <li><a id="a3" href="AdminBookingPage.html">manage bookings</a></li>
                  </ul>
              </li>
                    <li id="aa"><a  href="AdminUserPage.html"><span class="glyphicon glyphicon-user"></span> User</a></li>
                    <li id="aa"><a href="AdminSettingsPage.html"><span class="glyphicon glyphicon-cog"></span> System settings</a></li>
                </ul>
            </div>

        <!-- 表格内容-->
        <div id="main" >
          <!--   <img src="img/manage3.png "   width="100%" height="700px">  -->
          <p style="font-size: 50px;text-align: center; ">Sport Activities</p>
          <div class="row">
            <div class="columnLeft">
            <div class="bar">      
              <div class="card">
                <table class="table table-hover" style="font-size: 20px;">
                  <caption style="font-size: 30px;">4.22</caption>
                  <p>
                 
                    <button type="button" class="glyphicon glyphicon-plus" style="font-size: 20px;margin-left: 90%;margin-top: 10px;font-size: 20px;" title="Add" onclick="openAddModal()"></button>
                  
                  </p>
                  <thead>
                    <tr>
                      <th>Id</th>
                      <th>Name</th>
                      <th>StartTime</th>
                      <th>EndTime</th>
                      <th>Coach</th>
                      <th>Stadiums</th>
                      <th>Price</th>
                      <th>TicketNumber</th>
                      <th>Actions</th>
                      <th></th>
                      
                    </tr>
                  </thead>
                  <tbody>
                     <!-- 表格数据体 -->
                   
                      <tbody id="userDataBody"></tbody>
                  </tbody>
                </table>
              
              <!-- 分页栏 -->
                <ul class="pagination" style="margin-left: 300px;" >
                  <li><a href="#">&laquo;</a></li>
                  <li><a href="#">1</a></li>
                  <li><a href="#">2</a></li>
                  <li><a href="#">3</a></li>
                  <li><a href="#">4</a></li>
                  <li><a href="#">5</a></li>
                  <li><a href="#">&raquo;</a></li>
                </ul>
                <p></p>
              </div>
              </div>
            </div>
          </div>
      </div>
    </div>  
</div>
 <!-- edit的模态框 -->
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- 模态框内容 -->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Edit Sport Activity</h4>
            </div>
            <div class="modal-body">
                <form id="editForm">
                    <!-- 表单内容 -->
                    <div class="form-group">
                        <label for="editId"  >id:</label>
                        <input type="number" class="form-control" id="editId" readonly>
                    </div>
                    <div class="form-group">
                        <label for="editName">Name:</label>
                        
                        <select class="form-control" id="editName">
                            <!-- 动态填充选项 -->
                            <option value="Football">Football</option>
                            <option value="Basketball">Basketball</option>
                            <option value="Tennis">Tennis</option>
                            <option value="Archery">Archery</option>
                            <option value="Billiard">Billiard</option>
                            <option value="Shuttlecock">Shuttlecock</option>
                            <option value="Workout">Workout</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editStartTime">Start Time:</label>
                        <input type="datetime-local" class="form-control" id="editStartTime">
                    </div>
                    <div class="form-group">
                        <label for="editEndTime">End Time:</label>
                        <input type="datetime-local" class="form-control" id="editEndTime">
                    </div>
                    <div class="form-group">
                        <label for="editCoach">Coach:</label>
                        <select class="form-control" id="editCoach">
                            <!-- 动态填充选项 -->
                            <option value="coach1">Coach 1</option>
                            <option value="coach2">Coach 2</option>
                            <option value="coach3">Coach 3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editStadium">Stadium:</label>
                        <select class="form-control" id="editStadium">
                            <!-- 动态填充选项 -->
                            <option value="stadium1">Stadium 1</option>
                            <option value="stadium2">Stadium 2</option>
                            <option value="stadium3">Stadium 3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="price">Price:</label>
                        <input type="number" class="form-control" id="editPrice" required>
                    </div>
                    <div class="form-group">
                        <label for="ticketNumber">Ticket Number:</label>
                        <input type="number" class="form-control" id="editTicketNumber" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="saveChanges()">Save</button>

                   
                </form>
            </div>
        </div>
    </div>
</div>
  <!--add的模态框 -->
<div id="addModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- 模态框内容 -->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Add Sport Activity</h4>
            </div>
            <div class="modal-body">
                <form id="addForm">
                    <div class="form-group">
                        <label for="name">Name:</label>
                        <select class="form-control" id="name" required>
                            <!-- 动态填充选项 -->
                            <option value="Football">Football</option>
                            <option value="Basketball">Basketball</option>
                            <option value="Tennis">Tennis</option>
                            <option value="Archery">Archery</option>
                            <option value="Billiard">Billiard</option>
                            <option value="Shuttlecock">Shuttlecock</option>
                            <option value="Workout">Workout</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="startTime">Start Time:</label>
                        <input type="datetime-local" class="form-control" id="startTime" required>
                    </div>
                    <div class="form-group">
                        <label for="endTime">End Time:</label>
                        <input type="datetime-local" class="form-control" id="endTime" required>
                    </div>
                    <div class="form-group">
                        <label for="coach">Coach:</label>
                       
                        <select class="form-control" id="coach" required>
                            <!-- 动态填充选项 -->
                            <option value="coach1">Coach 1</option>
                            <option value="coach2">Coach 2</option>
                            <option value="coach3">Coach 3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="stadium">Stadium:</label>
                        <select class="form-control" id="stadium" required>
                            <!-- 动态填充选项 -->
                            <option value="stadium1">Stadium 1</option>
                            <option value="stadium2">Stadium 2</option>
                            <option value="stadium3">Stadium 3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="price">Price:</label>
                        <input type="number" class="form-control" id="price" required>
                    </div>
                    <div class="form-group">
                        <label for="ticketNumber">Ticket Number:</label>
                        <input type="number" class="form-control" id="ticketNumber" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="addSportActivity()">Add</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
  // JavaScript代码
document.getElementById('a1').addEventListener('click', function() {
            var submenu = this.querySelector('ul');
            if (submenu.style.display === 'none') {
                submenu.style.display = 'block';
            } else {
                submenu.style.display = 'none';
            }
        });
//获取体育活动数据
axios.get('http://localhost:8080/api/sportActivity')
        .then(response => {
            const activities = response.data;
            const userDataBody = document.getElementById('userDataBody');
            userDataBody.innerHTML = ''; // 清空表格内容

            activities.forEach(activity => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${activity.id}</td>
                    <td>${activity.name}</td>
                    <td>${activity.startTime}</td>
                    <td>${activity.endTime}</td>
                    <td>${activity.coach}</td>
                    <td>${activity.stadium}</td>
                    <td>${activity.price}</td>
                    <td>${activity.ticketNumber}</td>
                    <td>
                        <button type="button" class="glyphicon glyphicon-pencil" style="font-size: 10px;" title="Edit" data-toggle="modal" data-target="#myModal" onclick="populateEditForm(${activity.id})"></button>
                        
                        <button type="button" class="glyphicon glyphicon-minus" style="font-size: 10px;" title="Delete" onclick="confirmDelete(${activity.id})"></button>
                    </td>

                  
                `;
                userDataBody.appendChild(row);
            });
        })
.catch(error => {
    console.error('Error fetching sport activities:', error);
});

// 填充edit表单
function populateEditForm(id) {
    // 将数据填入编辑表单中的各个字段
    
    axios.get(`http://localhost:8080/api/sportActivity/${id}`)
        .then((response) => {
      /*       const activity = response.data; */
            const activity = JSON.stringify(response.data);
            console.log(response.data);

            // 更新表单中的字段值
            /* document.getElementById('editId').text=555; */
            /* document.getElementById('editId').innerHTML = 555; */
/*             $('#editId').val(111); */
            document.getElementById('editId').value = id;
            document.getElementById('editName').value = name;
            document.getElementById('editStartTime').value = activity.startTime;
            document.getElementById('editEndTime').value = activity.endTime;
            document.getElementById('editCoach').value = activity.coach;
            document.getElementById('editStadium').value = activity.stadium;
            document.getElementById('editPrice').value = activity.price;
            document.getElementById('editTicketNumber').value = activity.ticketNumber;
            console.log(activity);
            console.log(id);
        })
        .catch(error => {
            console.error('Error fetching sport activity details:', error);
            alert('Error fetching sport activity');
        });

}
// 保存修改
function saveChanges() {
    const updatedActivity = {
        id:document.getElementById('editId').value,
        name: document.getElementById('editName').value,
        startTime: document.getElementById('editStartTime').value,
        endTime: document.getElementById('editEndTime').value,
        coach: document.getElementById('editCoach').value,
        stadium: document.getElementById('editStadium').value,
        price: document.getElementById('editPrice').value,
        ticketNumber: document.getElementById('editTicketNumber').value
    };

    axios.put(`http://localhost:8080/api/sportActivity/${updatedActivity.id}`, updatedActivity)
        .then(response => {
            console.log('Activity updated successfully:', response.data);
            alert('Edit successfully.');
            $('#myModal').modal('hide');
            location.reload();
        })
        .catch(error => {
            console.error('Error updating activity:', error);
            alert('Failed to edit sport activity.'); 
        });
}


// 确认删除对话框
function confirmDelete(activityId) {
            if (confirm('Are you sure you want to delete this sport activity?')) {
                deleteSportActivity(activityId);
            }
        }

        // 删除体育活动
        function deleteSportActivity(activityId) {
            axios.delete(`http://localhost:8080/api/sportActivity/delete/${activityId}`)
                .then(response => {
                    alert(response.data); // 显示删除成功信息
                    // 刷新页面或重新获取数据
                    location.reload(); // 可以根据需求刷新页面或重新加载数据
                })
                .catch(error => {
                    console.error('Error deleting sport activity:', error);
                    alert('Failed to delete sport activity.'); // 显示删除失败信息
                });
        }
// 打开add模态框
function openAddModal() {
            $('#addModal').modal('show');
        }

// 添加体育活动
        function addSportActivity() {
            const name = document.getElementById('name').value;
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            const coach = document.getElementById('coach').value;
            const stadium = document.getElementById('stadium').value;
            const price = document.getElementById('price').value;
            const ticketNumber = document.getElementById('ticketNumber').value;

            const newActivity = {
                name: name,
                startTime: startTime,
                endTime: endTime,
                coach: coach,
                stadium: stadium,
                price: price,
                ticketNumber: ticketNumber
            };

            axios.post('http://localhost:8080/api/sportActivity/add', newActivity)
                .then(response => {
                    alert('Sport activity added successfully.');
                    location.reload(); // 可以根据需求刷新页面或重新加载数据
                })
                .catch(error => {
                    console.error('Error adding sport activity:', error);
                    alert('Failed to add sport activity.');
                });
        }
</script>


</body>
</html>
